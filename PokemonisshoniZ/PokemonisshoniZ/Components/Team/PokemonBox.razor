@page "/PokemonBox"

@using PokemonisshoniZ.Data

@inject ContextMenuService ContextMenuService

@inject AuthenticationStateProvider AuthenticationStateProvider

@attribute [StreamRendering]
@rendermode InteractiveAuto
@attribute [Authorize]

@inject ApplicationDbContext _context
@inject PokemonisshoniZ.Services.PokemonisshoniService PokemonisshoniService


<RadzenRow>
    <RadzenColumn Size="12">
        <RadzenRow>
            <RadzenColumn Size="12" SizeMD="1">
                <RadzenButton Icon="keyboard_arrow_left" class="w-100"></RadzenButton>
            </RadzenColumn>
            <RadzenColumn Size="12" SizeMD="10" class="text-center px-lg-5 px-0">
                <RadzenDropDown Data="@_pCLPokemonBoxes" 
                    ValueProperty="BoxIdx" TextProperty="Name" @bind-Value="selectIdx"
                class="text-center w-100">

                </RadzenDropDown>
            </RadzenColumn>
            <RadzenColumn Size="12" SizeMD="1">
                <RadzenButton Icon="keyboard_arrow_right" class="w-100"></RadzenButton>

            </RadzenColumn>
        </RadzenRow>

    </RadzenColumn>
    <RadzenColumn Size="12">

     <RadzenRow>
            <RadzenColumn Size="0" SizeLG="1"></RadzenColumn>
        <RadzenColumn SizeLG="10" Size="12">
                <RadzenDataList Data="_pCLPokemonBoxes[selectIdx].PCLPokemonIds">

            </RadzenDataList>
                <PokemonButton ContextMenu="ShowContextMenuWithItems"> </PokemonButton>
        </RadzenColumn>
        <RadzenColumn Size="0" SizeLG="1"></RadzenColumn>

    </RadzenRow>
   </RadzenColumn>
</RadzenRow>

@code {
    string[] boxes = Enumerable.Range(1, 30).Select(s => $"箱子{s}").ToArray();
    int selectIdx = 0;

    PCLPokemonBox[] _pCLPokemonBoxes;

    // IEnumerable<DataItem> 

    protected override Task OnInitializedAsync()
    {
        _pCLPokemonBoxes.Select(s => new DataItem ( s.Name, s.BoxIdx));
        return base.OnInitializedAsync();
    }

    void ShowContextMenuWithItems(MouseEventArgs args)
    {
        ContextMenuService.Open(args,
            new List<ContextMenuItem> {
                new ContextMenuItem(){ Text = "复制", Value = 1, Icon = "search" },
                new ContextMenuItem(){ Text = "放生", Value = 2, Icon = "delete" },
                 }, OnMenuItemClick);
    }

    void OnMenuItemClick(MenuItemEventArgs args)
    {
        if ((int)args.Value == 1)
        {

        }
    }

    public record DataItem(string Name, int Idx);
}
